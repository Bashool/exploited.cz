<?php
ini_set('default_charset', 'UTF-8');
session_start();
if (isset($_GET['save'])) {
	$_SESSION['header'] = $_SERVER['HTTP_HOST'];
	$message = 'Set to ' . $_SERVER['HTTP_HOST'];
} elseif (isset($_GET['clear'])) {
	unset($_SESSION['header']);
	header('Location: http://exploited.cz/host/');
} else {
	$message = (isset($_SESSION['header']) ? $_SESSION['header'] : 'Not saved');
}
?>
<html>
<head><title>Host header</title></head>
<body>
	<h3>Host header</h3>
	<p><?php echo $message; /* Schválně bez htmlspecialchars(), hlavička Host přece nemůže obsahovat HTML značky, neasi. */ ?></p>
	<p><a href="/host/?save">Set header</a></p>
	<p><a href="/host/">Show header</a></p>
	<p><a href="/host/?clear">Clear header</a></p>
	<p><strong>Na exploited.cz nefunguje, protože před serverem je nginx jako reverzní proxy a ta nejspíš ztratí hostname z GET požadavku.</strong></p>
</body>
</html>
