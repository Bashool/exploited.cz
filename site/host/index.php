<?php
ini_set('default_charset', 'UTF-8');
$file = './host.txt';
if (isset($_GET['save'])) {
	file_put_contents($file, $_SERVER['HTTP_HOST']);
	$message = 'Set to ' . $_SERVER['HTTP_HOST'];
} elseif (isset($_GET['clear'])) {
	unlink($file);
	header('Location: http://exploited.cz/host/');
} else {
	$message = (is_readable($file) ? file_get_contents($file) : 'Not saved');
}
?>
<html>
<head><title>Host header</title></head>
<body>
	<h3>Host header</h3>
	<p><?php echo $message; /* Schválně bez htmlspecialchars(), hlavička Host přece nemůže obsahovat HTML značky, neasi. */ ?></p>
	<p><a href="/host/?save">Set header</a></p>
	<p><a href="/host/">Show header</a></p>
	<p><a href="/host/?clear">Clear header</a></p>
	<p><strong>Na exploited.cz nefunguje, protože před serverem je nginx jako reverzní proxy a ta nejspíš ztratí hostname z GET požadavku.</strong></p>
</body>
</html>
