<?php
session_start();
$csp = (isset($_GET['csp']) ? $_GET['csp'] : '');
$report = "report-uri /xss/csp-report.php?report";
switch ($csp) {
	case 'none':
		header("Content-Security-Policy: default-src 'none'; {$report}");
		break;
	case 'inline':
		header("Content-Security-Policy: default-src 'none'; script-src 'unsafe-inline'; {$report}");
		break;
	case 'google':
		header("Content-Security-Policy: default-src 'none'; script-src 'unsafe-inline' ajax.googleapis.com; {$report}");
		break;
	case 'cloudflare':
		header("Content-Security-Policy: default-src 'none'; script-src 'unsafe-inline' cdnjs.cloudflare.com; {$report}");
		break;
}
?>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/knockout/3.4.2/knockout-min.js"></script>
<script>alert('jQuery: ' + (typeof $ == 'undefined' ? 'not loaded' : $.fn.jquery));</script>
<script>alert('Knockout: ' + (typeof ko == 'undefined' ? 'not loaded' : ko.version));</script>
<script>alert('Some inline JavaScript');</script>
<p><a href="csp.php">No CSP</a></p>
<p><a href="?csp=none">CSP = none</a></p>
<p><a href="?csp=inline">CSP = inline</a></p>
<p><a href="?csp=google">CSP = google (for jQuery)</a></p>
<p><a href="?csp=cloudflare">CSP = cloudflare (for Knockout)</a></p>
